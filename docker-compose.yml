services:
  dataprep:
    build:
      context: .
      dockerfile: docker/Dockerfile.dataprep
    ports:
      - "8001:8001"
    env_file:
      - .env
    volumes:
      - ./config.yaml:/app/config.yaml
      - ./urls.txt:/app/urls.txt
      - ./data:/app/data
      - ./output:/app/output
      - ./logs:/app/logs
    restart: unless-stopped

  agentic-research:
    build:
      context: .
      dockerfile: docker/Dockerfile.backend
    env_file:
      - .env
    environment:
      MCP_DATAPREP_URL: http://dataprep:8001/sse
      MCP_FS_COMMAND: node
      MCP_FS_ARGS: /usr/local/lib/node_modules/@modelcontextprotocol/server-filesystem/dist/index.js
    volumes:
      - ./config.yaml:/app/config.yaml
      - ./urls.txt:/app/urls.txt
      - ./data:/app/data
      - ./output:/app/output
      - ./logs:/app/logs
    stdin_open: true
    tty: true
    profiles:
      - cli
